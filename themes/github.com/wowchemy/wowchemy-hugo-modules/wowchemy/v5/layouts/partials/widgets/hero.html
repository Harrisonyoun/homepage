{{ $ := .root }}
{{ $page := .page }}
{{ $author_page := .author_page }}

<div class="hero-section text-center">

  {{/* Hero Avatar Image */}}
  {{ $avatar := ($author_page.Resources.ByType "image").GetMatch "*avatar*" }}
  {{ if $avatar }}
    <div class="hero-avatar">
      <img src="{{ $avatar.RelPermalink }}" alt="{{ $author_page.Title }}" style="width: 150px; height: auto; border-radius: 50%; margin-bottom: 20px;">
    </div>
  {{ end }}

  {{/* Hero Title */}}
  {{ with $page.Title }}
    <h1 class="hero-title" style="font-weight: bold; margin-bottom: 15px;">{{ . | markdownify }}</h1>
  {{ end }}

  {{/* Hero Lead Text */}}
  {{ with $page.Content }}
    <div class="hero-lead" style="margin-bottom: 20px;">{{ . | markdownify }}</div>
  {{ end }}

  {{/* Call-to-action link */}}
  {{ if $page.Params.cta.url }}
    {{ $link := $page.Params.cta.url }}
    {{ $scheme := (urls.Parse $link).Scheme }}
    {{ $target := "" }}
    {{ if not $scheme }}
      {{ $link = $link | relLangURL }}
    {{ else if in (slice "http" "https") $scheme }}
      {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
    {{ end }}
    <a href="{{ $link | safeURL }}" {{ $target | safeHTMLAttr }} class="btn btn-primary" style="background-color: #8b0000; color: #ffffff; padding: 10px 20px; text-decoration: none;">{{ $page.Params.cta.label | markdownify | emojify | safeHTML }}</a>
  {{ end }}

  {{/* Alternative Call-to-action link */}}
  {{ if $page.Params.cta_alt.url }}
    {{ $link := $page.Params.cta_alt.url }}
    {{ $scheme := (urls.Parse $link).Scheme }}
    {{ $target := "" }}
    {{ if not $scheme }}
      {{ $link = $link | relLangURL }}
    {{ else if in (slice "http" "https") $scheme }}
      {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
    {{ end }}
    <a href="{{ $link | safeURL }}" {{ $target | safeHTMLAttr }} class="hero-cta-alt btn-lg" style="margin-left: 10px; text-decoration: none;">{{ $page.Params.cta_alt.label | markdownify | emojify | safeHTML }} <i class="fas fa-angle-right"></i></a>
  {{ end }}

  {{/* Call-to-action note */}}
  {{ with $page.Params.cta_note }}
    <p class="hero-note text-muted" style="margin-top: 10px;">{{ .label | markdownify | emojify | safeHTML }}</p>
  {{ end }}

  {{/* Hero image */}}
  {{ if $page.Params.hero_media }}
    {{- $image := ($page.Parent.Resources.ByType "image").GetMatch $page.Params.hero_media -}}
    {{- if not $image -}}
      {{- $image = resources.Get (path.Join "media" $page.Params.hero_media) -}}
    {{- end }}
    {{ if $image }}
      {{ $isSVG := eq $image.MediaType.SubType "svg" }}
      {{ if $isSVG }}
        <img src="{{ $image.RelPermalink }}" alt="{{ $page.Title }}" style="margin-top: 20px;">
      {{ else }}
        {{ $legacy_img := $image.Resize "400x" }}
        {{ $img_src := "" }}
        {{ $img_src_set := slice }}
        {{ $widths := slice 1200 800 400 }}

        {{ range $widths }}
          {{ $src_link := ($image.Resize (printf "%dx" .)).RelPermalink }}
          {{ if eq $img_src "" }}
            {{ $img_src = $src_link }}
          {{ end }}
          {{ $img_src_set = $img_src_set | append (printf "%s %dw" $src_link .) }}
        {{ end }}
        {{ $img_src_set = delimit $img_src_set "," }}

        <img src="{{ $legacy_img.RelPermalink }}" srcset="{{ $img_src_set }}" width="{{ $image.Width }}" height="{{ $image.Height }}" alt="{{ $page.Title }}" style="margin-top: 20px;">
      {{ end }}
    {{ end }}
  {{ end }}

</div>
